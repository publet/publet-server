{% load static from staticfiles %}

<!DOCTYPE html>
<html lang="en" class="{% block html-class %}{% endblock %}" ng-app="Publet">
<head>
  <title>{% block page-title %}Publet{% endblock %}</title>

  <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
  <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="" />
  <meta charset="utf-8" />

  <link href='//fonts.googleapis.com/css?family=Muli:300,400,300italic,400italic' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css' />
  <link href='//fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css' />
  <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
  {% block extra_fonts %}{% endblock %}

  <link rel="stylesheet" href="{% static 'css/pure-min.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'css/vendor/glyphicons.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'css/vendor/select2/select2.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'components/medium-editor/dist/css/medium-editor.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'components/medium-editor/dist/css/themes/default.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'css/vendor/jquery.Jcrop.min.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'css/style-browser.css' %}" type="text/css" media="screen" charset="utf-8" />
  <link rel="stylesheet" href="{% static 'components/jquery-ui/themes/smoothness/jquery-ui.min.css' %}" type="text/css" media="screen" charset="utf-8" />

  <style>
    {% block css %}{% endblock %}
  </style>

  <script src="{% static 'components/jquery/dist/jquery.min.js' %}"></script>
  <script src="{% static 'components/underscore/underscore.js' %}"></script>
  <script src="{% static 'components/jquery-timeago/jquery.timeago.js' %}"></script>
  <script src="{% static 'js/vendor/select2.js' %}"></script>
  <script src="{% static 'components/angular/angular.min.js' %}"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="{% static 'components/angular-animate/angular-animate.min.js' %}"></script>
  <script src="{% static 'components/jquery-ui/jquery-ui.min.js' %}"></script>
  <script src="{% static 'js/vendor/angular-select2.js' %}"></script>
  <script src="{% static 'js/vendor/jquery.flexslider-min.js' %}"></script>
  <script src="{% static 'js/vendor/angular-flexslider.js' %}"></script>
  <script src="{% static 'js/events.js' %}"></script>
  <script src="{% static 'js/vimeo.js' %}"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <script src="{% static 'components/medium-editor/dist/js/medium-editor.min.js' %}"></script>
  <script src="{% static 'components/csv-js/csv.js' %}"></script>
  <script src="{% static 'js/vendor/jquery.Jcrop.min.js' %}"></script>
  <script src="{% static 'components/highcharts/highcharts.js' %}" type="text/javascript"></script>
  <script src="{% static 'components/highcharts-ng/dist/highcharts-ng.min.js' %}" type="text/javascript"></script>
  <script src="{% static 'components/moment/min/moment.min.js' %}" type="text/javascript"></script>
  {% block extra_js %}{% endblock %}

  <script type="text/javascript" src="//api.filepicker.io/v1/filepicker.js" charset="utf-8"></script>
  <script src="//connect.soundcloud.com/sdk.js"></script>

  {% if debug %}

    <script type="text/javascript" src="{% static 'js/polyfills.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/utility-functions.js' %}" charset="utf-8"></script>

    <script type="text/javascript" src="{% static 'js/app.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/utility-directives.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/services/storages.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/blocks.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/groups.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/publications.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/articles.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/services/api.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/services/save.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/theme-editor.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/video-directives.js' %}" charset="utf-8"></script>

    <script type="text/javascript" src="{% static 'js/blocks/photo-block.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/blocks/text-block.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/blocks/video-block.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/blocks/audio-block.js' %}" charset="utf-8"></script>

    <script type="text/javascript" src="{% static 'js/interface-modules.js' %}" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/interface.js' %}" charset="utf-8"></script>

  {% else %}

    <script type="text/javascript" src="{% static 'js/publet.min.js' %}" charset="utf-8"></script>

  {% endif %}

  {% block javascript %}{% endblock %}

  <script type="text/javascript" charset="utf-8">
    window.user = '{{ request.user }}';
    window.user_api_key = '{{ request.user.publet_api_key.key }}';
    {% block inline-js %}{% endblock %}
  </script>

  <!--[if lt IE 9]>
  <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  {% if GOOGLE_ANALYTICS_ID %}
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', '{{ GOOGLE_ANALYTICS_ID }}', 'publet.com');
      ga('send', 'pageview');
    </script>
  {% endif %}

</head>
<body class="{% block body-class %}{% endblock %}">
  {% block nav %}
<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="/">
                <img alt="Brand" class="img-responsive" src="{% static 'img/publet-logo-dark.png' %}">
            </a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle clearfix content-heading" data-toggle="dropdown" role="button"

                       aria-haspopup="true"
                       aria-expanded="false">

                        <img src="https://placehold.it/36x36" class="img-circle pull-left" alt=""/>

                        <h5 class="pull-left">&nbsp; {{ request.user.username }}</h5></a>
                    <ul class="dropdown-menu primary-dropdown">
                        <li><a href="#">Action</a></li>
                {% if request.user.is_authenticated %}
                      <li><a href="{% url 'profile' %}">Profile</a></li>
                      <li><a href="/password/change/">Change Password</a></li>
                      <li><a href="{% url 'change-email' %}">Change Email</a></li>
                      <li><a href="{% url 'docs-index' %}">Help</a></li>
                      {% if request.user.is_superuser %}
                        <li><a href="/admin/">Admin</a></li>
                        <li><a href="{% url 'theme-list' %}">Themes</a></li>
                      {% endif %}
                      {% if current_commit %}
                        <li>
                          <a href="https://github.com/publet/publet/commit/{{ current_commit }}">
                            Git SHA: {{ current_commit_abbr }}
                          </a>
                        </li>
                      {% endif %}
                        <li><a href="/logout/?next={% firstof next request.path %}">Log out</a></li>
                    </div>
                  {% else %}
                    {% if not hide_login_signup %}
                      <li><a href="/login/?next={% firstof next request.path %}">Log in</a></li>
                      <li><a href="/signup/?next={% firstof next request.path %}">Sign up</a></li>
                    {% endif %}
                {% endif %}
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

  {% endblock %}

  {% block main %}
    <div class="container">
      <section id="main" class="sixteen columns">
        <div class="stage">
          {% block content %}{% endblock %}
        </div>
      </section>
    </div>
  {% endblock %}

  {% if debug and USE_LIVE_RELOAD %}
    <script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
  {% endif %}

  {% block modals %}{% endblock %}

  {% if not debug %}

    {% if user.is_authenticated and user.profile.is_author %}
      <script id="IntercomSettingsScriptTag">
        window.intercomSettings = {
          email: "{{ request.user.email }}",
          created_at: {{ request.user.date_joined|date:"U" }},
          app_id: "{{ INTERCOM_APP_ID }}",
          widget: {
            activator: "#IntercomDefaultWidget"
          }
        };
      </script>
      <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://static.intercomcdn.com/intercom.v1.js';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}};})()</script>
    {% endif %}

  {% endif %}

  <!--
  {% if not user.is_anonymous %}
    <div class="i-wish" ng-controller="FeedbackController">
      <p>
        I wish this page would
        <input type="text" ng-model="text" />
        <button ng-click="submit()">[[ button ]]</button>
      </p>
    </div>
  {% endif %}
  -->

</body>
</html>
